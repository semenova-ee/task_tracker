# Проект "Трекер задач сотрудников"  

## Общее назначение
Сервис создан для создания, хранения, обновления и отслеживания задач сотрудников.
А также выполняет отчетные выборки по занятым сотрудникам и важным задачам.

<hr>

## Запуск проекта

1. Клонируйте исходники проекта:
```
https://github.com/semenova-ee/task_tracker/
```


2. Создайте файл `.env` и запишите в него параметры для баз данных (основной и тестовой).
Пример структуры файла в `.env_sample`


3. Запустите проект с помощью docker-compose
```
docker-compose up --build
```

Возможно порты или названия контейнеров уже заняты. В этом случае проект не соберется. Очистите контейнеры и volume и попробуйте перезапустить сборк заново. Для очистки можно использовать команды
```
docker rm -vf $(docker ps -a -q)
docker volume rm $(docker volume ls -q --filter dangling=true)
```

<ins>!!! После успешной сборки вы можете перейти к swagger-документации для ознакомления с api !!!</ins>

При локальном запуске:

```
http://localhost:8000/swagger/
```

<hr>

## Функциональность

Данные в сервисе основаны на 2 связанных друг с другом сущностях:
Сотрудник и Задача. Для каждой сущности реализован механизм CRUD.

### Модель Employee представляет отдельные задачи в системе. Она содержит следующие поля:
- **Роль:** Обязательное поле для указания роли работника.
- **Ник:** Oбязательное поле,для указания ника работника.
- **Имя:** Обязательное поле для указания имени работника.
- **Пароль** Обязательное поле для указания пароля работника.


При создании и обновлении сотрудника стоит запрет на создание двух сотрудников с одинаковым именем.

Эндпоинты CRUD реализованы по префиксу `api/users/`


### Модель Task представляет отдельные задачи в системе. Она содержит следующие поля:

- **Название:** Обязательное поле для указания заголовка или названия задачи.
- **Описание:** Необязательное поле, предоставляющее дополнительные сведения или информацию о задаче.
- **Статус:** Определяет текущий статус задачи, выбираемый из заранее определенного набора: Ожидает, В Процессе или Завершено. По умолчанию устанавливается как Ожидает, если не указано иное.
- **Срок выполнения:** Указывает крайний срок выполнения задачи. Это обязательное поле.
- **Родительская Задача:** Необязательное поле, представляющее родительскую задачу, если задача является подзадачей другой задачи.
- **Исполнитель:** Представляет сотрудника, назначенного на выполнение задачи. Это поле является необязательным и может оставаться пустым, если задача не назначена.
- **Дочерние Задачи:** Поле отношения Многие-ко-Многим, позволяющее задачам иметь дочерние задачи.

Статус задачи может принимать только три значения: pending, in progress, completed.
Если статус не задан, ему автоматически присваивается значение pending. 

Эндпоинты CRUD реализованы по префиксу `api/tasks/`


### Отчетные выборки
Реализованы 2 отчетные выборки.

- **Занятые сотрудники**
  
  ```get('api/users/busy-users')```

  Возвращает всех сотрудников, на которых назначены незакрытые задачи.
  Сортирует список по уменьшению занятости (сначала сотрудники у которых больше незакрытых задач).
  Для каждого сотрудника добавляет список его задач. 


- **Важные задачи**
  ```get('api/users/important-tasks')```

  Отбирает задачи со статусом pending, у которых есть дочерние задачи.
  
  К таким задачам подбирает наиболее подходящих для выполнения сотрудников:
  - Наименее загруженный сотрудник или сотрудник выполняющий родительскую задачу если ему назначено максимум на 2 задачи больше, чем у наименее загруженного сотрудника
  - Возвращает отобранные задачи, дополненные сроком реализации и url сотрудника, наиболее подходящего для выполнения задачи. 


### Документация

Подключена автоматически генерируемая api-документация swagger.
```
/swagger/
```

### Тестирование

Код сервиса покрыт тестами pytest.
85%

### Docker

- Описан Dockerfile для fastapi-приложения
- Создан docker-compose для всех сервисов, необходимых для запуска приложения
(django-приложение, postgresql для основной БД)

<hr>

## Стэк технологий
<img src="https://img.shields.io/badge/python-134881?style=for-the-badge&logo=python&logoColor=ffffff"/> <img src="https://img.shields.io/badge/swagger-134881?style=for-the-badge&logo=swagger&logoColor=ffffff"/> <img src="https://img.shields.io/badge/docker-134881?style=for-the-badge&logo=docker&logoColor=ffffff"/> <img src="https://img.shields.io/badge/docker%20compose-134881?style=for-the-badge&logo=docker&logoColor=ffffff"/> <img src="https://img.shields.io/badge/pytest-134881?style=for-the-badge&logo=pytest&logoColor=ffffff"/> <img src="https://img.shields.io/badge/django-134881?style=for-the-badge&logo=django&logoColor=ffffff"/>
